## 分区表的原理
对用户而言，分区表是一个独立的逻辑表，但是底层MySQL将其分成了多个物理字表，这对用户来说是透明的，每一个分区表都会使用一个独立的表文件

通过partition by 字句定义每个分区存放的数据，执行查询时优化器会根据分区定义过滤那些没有我们需要数据的分区，这样查询只需要查询所需数据的分区即可

### 使用场景

表非常大，无法全部存在内存，或者只在表的最后有热点数据，其他是历史数据

分区表的数据更容易维护

分区表的数据可以分部在不同的机器上，从而高效使用资源

使用分区表避免某些瓶颈

可以单独备份恢复独立的分区

### 缺点

一个表只能有1024个分区

分区字段中如果有主见和唯一索引列，那么主键列和唯一列都必须包含进来

分区表中无法使用外键约束

如果已有表需要分区，需要对表结构进行修改

所有分区必须使用相同的存储引擎

分区函数中使用的表达式和函数有限制

某些存储引擎不支持分区

对于myisam分区表，不能把索引缓存到内存中，切需要打开更多的文件描述符

## 分库分表的原理
通过一些hash算法或工具实现将一张数据库垂直或者水平进行物理切分

### 使用场景
单表记录达到百万或者千万时

解决表锁问题

### 分表方式

水平分割： 表很大，分割后可以降低在查询时需要读的数据和索引的页数，同时也降低了索引的层数，提高查询速度

把一张表变成结构相同的多张小表

使用场景：
表中数据有独立性，表中分别记录各个地区的数据或不同时期的数据

需要把数据放在多个介质上，比如最新的数据做缓存，或放在不同服务器上

缺点：给应用增加复杂度，需要union多个表名

在数据库应用中，这种复杂性会超过他的优点



垂直分割：
把主键和一些列放在一个表中，然后把主键和另外的列放在另一个表中

使用场景：

一个表中某些列常用，另外不常用

可以使数据行变小

缺点：
查询需要关联


分表的缺点：有些分表的策略基于应用层的逻辑算法，一但逻辑算法改变，整个分表逻辑都会变，扩展性不好

对于应用层来说，逻辑算法增加开发成本

## 复制原理及负载均衡

主从复制是在主库上把数据更改记录到binlog,从库将主库的日志复制到中继日志中，从库读取中继日志的时间，将其重放到从库数据中


解决问题：
1. 数据分布，随意停止或开始复制，并在不同地理位置分布数据备份
2. 负载均衡，降低单个服务器压力
3. 高可用和故障切换，帮助应用程序避免单点失败
4. 升级测试，可以使用更高版本的MySQL作为从库

